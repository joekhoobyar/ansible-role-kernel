# Kernel installation
kernel_srcdir: /usr/src/linux

# Default kernel configs
kernel_config_defaults:
  # Generally desired
  CONFIG_PACKET_DIAG: y
  CONFIG_UNIX_DIAG: y
  CONFIG_PSAMPLE: y
  CONFIG_LWTUNNEL: y
  CONFIG_NET_DEVLINK: y
  CONFIG_NET_IPVTI: m
  CONFIG_IP_SET: y
  CONFIG_IP_SET_MAX: 256
  CONFIG_IP_SET_HASH_IP: ym
  CONFIG_IP_SET_HASH_NET: ym
  CONFIG_NF_CONNTRACK_SNMP: ym
  CONFIG_CHECKPOINT_RESTORE: y
  # Desired for docker performance
  CONFIG_OVERLAY_FS_REDIRECT_DIR: y
  CONFIG_BLK_CGROUP_IOLATENCY: y
  CONFIG_BLK_CGROUP_IOCOST: y
  CONFIG_BLK_CGROUP_IOPRIO: y

  # Needed for base k8s installation
  CONFIG_CPUSETS: ym
  CONFIG_VETH: ym
  CONFIG_IP_NF_FILTER: ym
  CONFIG_IP_NF_TARGET_MASQUERADE: ym
  CONFIG_IP_NF_TARGET_NETMAP: ym
  CONFIG_IP_NF_TARGET_REDIRECT: ym
  CONFIG_IP_NF_TARGET_REJECT: ym
  CONFIG_NF_CONNTRACK: ym
  CONFIG_NF_CONNTRACK_EVENTS: ym
  CONFIG_NF_CONNTRACK_TIMEOUT: ym
  CONFIG_NF_CONNTRACK_TIMESTAMP: ym
  CONFIG_NF_CT_NETLINK: ym
  CONFIG_NETFILTER_CONNCOUNT: ym
  CONFIG_NFT_CONNLIMIT: ym
  CONFIG_NFT_FIB: ym
  CONFIG_NFT_FIB_IPV6: ym
  CONFIG_NETFILTER_NETLINK_LOG: ym
  CONFIG_NF_CT_NETLINK_TIMEOUT: ym
  CONFIG_NF_CT_NETLINK_HELPER: ym
  CONFIG_NETFILTER_NETLINK_GLUE_CT: ym
  CONFIG_NETFILTER_XT_SET: ym
  CONFIG_NETFILTER_XT_MATCH_ADDRTYPE: ym
  CONFIG_NETFILTER_XT_MATCH_CGROUP: ym
  CONFIG_NETFILTER_XT_MATCH_CLUSTER: ym
  CONFIG_NETFILTER_XT_MATCH_COMMENT: ym
  CONFIG_NETFILTER_XT_MATCH_CONNLABEL: ym
  CONFIG_NETFILTER_XT_MATCH_CONNLIMIT: ym
  CONFIG_NETFILTER_XT_MATCH_CONNMARK: ym
  CONFIG_NETFILTER_XT_MATCH_CONNTRACK: ym
  CONFIG_NETFILTER_XT_MATCH_DEVGROUP: ym
  CONFIG_NETFILTER_XT_MATCH_HELPER: ym
  CONFIG_NETFILTER_XT_MATCH_IPRANGE: ym
  CONFIG_NETFILTER_XT_MATCH_IPVS: ym
  CONFIG_NETFILTER_XT_MATCH_MAC: ym
  CONFIG_NETFILTER_XT_MATCH_MARK: ym
  CONFIG_NETFILTER_XT_MATCH_MULTIPORT: ym
  CONFIG_NETFILTER_XT_MATCH_OWNER: ym
  CONFIG_NETFILTER_XT_MATCH_PHYSDEV: ym
  CONFIG_NETFILTER_XT_MATCH_PKTTYPE: ym
  CONFIG_NETFILTER_XT_MATCH_REALM: ym
  CONFIG_NETFILTER_XT_MATCH_RECENT: ym
  CONFIG_NETFILTER_XT_MATCH_SOCKET: ym
  CONFIG_NETFILTER_XT_MATCH_STATISTIC: ym
  CONFIG_NF_TABLES_INET: ym
  CONFIG_NFT_NUMGEN: ym
  CONFIG_NFT_CT: ym
  CONFIG_NFT_LOG: ym
  CONFIG_NFT_MASQ: ym
  CONFIG_NFT_REDIR: ym
  CONFIG_NFT_NAT: ym
  CONFIG_NFT_TUNNEL: ym
  CONFIG_NFT_REJECT: ym
  CONFIG_NF_DUP_NETDEV: ym
  CONFIG_NFT_DUP_NETDEV: ym
  CONFIG_IP_NF_NAT: ym
  CONFIG_NF_NAT: ym
  CONFIG_NF_NAT_REDIRECT: ym
  CONFIG_CGROUP_PERF: ym  # optional for statistics gathering
  CONFIG_CGROUP_HUGETLB: ym
  CONFIG_NET_CLS_CGROUP: ym
  CONFIG_IP_VS: ym
  CONFIG_IP_VS_IPV6: ym
  CONFIG_IP_VS_LC: ym
  CONFIG_IP_VS_WLC: ym
  CONFIG_IP_VS_PROTO_TCP: ym
  CONFIG_IP_VS_PROTO_UDP: ym
  CONFIG_IP_VS_NFCT: ym
  CONFIG_IP_VS_RR: ym
  CONFIG_IP_VS_WRR: ym
  CONFIG_IP_VS_DH: ym
  CONFIG_IP_VS_SH: ym
  CONFIG_IP_VS_OVF: ym
  CONFIG_IPVLAN: ym
  CONFIG_DUMMY: ym
  CONFIG_CGROUP_NET_PRIO: ym
  CONFIG_NF_SOCKET_IPV4: ym
  CONFIG_NF_TABLES_IPV4: ym
  CONFIG_NF_SOCKET_IPV6: ym
  CONFIG_NF_TABLES_IPV6: ym
  # Needed for libvirt and qemu
  CONFIG_SCSI_ISCSI_ATTRS: m
  CONFIG_BRIDGE_EBT_MARK_T: ym
  CONFIG_VLAN_8021Q_GVRP: y
  CONFIG_VLAN_8021Q_MVRP: y
  CONFIG_NETFILTER_XT_TARGET_CHECKSUM: ym
  CONFIG_NETFILTER_XT_TARGET_CLASSIFY: ym
  CONFIG_NETFILTER_XT_TARGET_NETMAP: ym
  CONFIG_NETFILTER_XT_TARGET_NFQUEUE: ym
  CONFIG_NETFILTER_XT_TARGET_REDIRECT: ym
  CONFIG_IP_NF_MANGLE: ym
  CONFIG_IP6_NF_MANGLE: ym
  CONFIG_IP6_NF_FILTER: ym
  CONFIG_IP6_NF_TARGET_REJECT: ym
  CONFIG_IP6_NF_NAT: ym
  CONFIG_IP6_NF_TARGET_MASQUERADE: ym
  CONFIG_IP6_NF_TARGET_NPT: ym
  CONFIG_BRIDGE_EBT_T_NAT: ym
  CONFIG_NET_SCHED: y
  CONFIG_NET_CLS_ACT: y
  CONFIG_NET_ACT_POLICE: ym
  CONFIG_NET_CLS_FW: ym
  CONFIG_NET_CLS_U32: ym
  CONFIG_NET_SCH_FQ: ym
  CONFIG_NET_SCH_HTB: ym
  CONFIG_NET_SCH_SFQ: ym
  CONFIG_NET_SCH_INGRESS: ym
  CONFIG_NET_SCH_QFQ: ym
  CONFIG_NET_SCH_CODEL: ym
  CONFIG_NET_SCH_FQ_CODEL: ym
  CONFIG_NFT_COUNTER: y
  CONFIG_NFT_LIMIT: y
  CONFIG_NFT_OBJREF: y
  CONFIG_NFT_QUEUE: y
  CONFIG_NFT_QUOTA: y
  CONFIG_NFT_COMPAT: y
  CONFIG_NFT_HASH: y
  CONFIG_NFT_XFRM: y
  CONFIG_NFT_SOCKET: y
  CONFIG_NFT_OSF: y
  CONFIG_NFT_TPROXY: y
  CONFIG_NF_FLOW_TABLE_INET: y
  CONFIG_NF_FLOW_TABLE: y
  CONFIG_NETFILTER_XT_TARGET_CONNMARK: y
  CONFIG_NETFILTER_XT_TARGET_TPROXY: y
  CONFIG_NETFILTER_XT_MATCH_IPCOMP: y
  CONFIG_NETFILTER_XT_MATCH_LENGTH: y
  CONFIG_NETFILTER_XT_MATCH_LIMIT: y
  CONFIG_NETFILTER_XT_MATCH_OSF: y
  # Desired config
  CONFIG_BRIDGE_VLAN_FILTERING: y
  CONFIG_BRIDGE_NF_EBTABLES: ym

